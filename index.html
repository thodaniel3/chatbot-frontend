<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MME Department Chatbot</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
  <h1>MME Department Chatbot</h1>
  <p class="subtitle">Ask questions based on departmental materials</p>

  <input type="text" id="question" placeholder="Type your question here">
  <button onclick="askQuestion()">Ask</button>

  <div id="answer"></div>

  <hr>

  <button class="admin-btn" onclick="window.location.href='admin.html'">
    Admin Login
  </button>
</div>

<script>
const backendUrl = "https://chatbot-backend-2nxq.onrender.com";

async function askQuestion() {
  const question = document.getElementById("question").value.trim();
  if (!question) return alert("Please type a question.");

  const res = await fetch(`${backendUrl}/ask`, {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({ question })
  });

  const data = await res.json();
  const answerDiv = document.getElementById("answer");
  answerDiv.innerHTML = "";

  if (!data.matches || data.matches.length === 0) {
    answerDiv.innerHTML = "<p><b>No answer found.</b></p>";
    return;
  }

  data.matches.forEach((m,i)=>{
    answerDiv.innerHTML += `
      <div class="card">
        <div class="card-title">Answer ${i+1}</div>
        <div class="card-meta"><b>Lecturer:</b> ${m.lecturer || "Unknown"}</div>
        <div class="card-meta"><b>Source:</b> ${m.source || "Unknown"}</div>
        <p>${m.snippet}</p>
        ${m.file_url ? `<a class="file-link" href="${m.file_url}" target="_blank">Open File</a>` : ""}
      </div>
    `;
  });
}
</script>
</body>
</html>
